<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Keyboard Layout Research</title>
  <style>
    input {
      width: 200px
    }
    .question {
      padding: 8px;
      background-color: lightgrey;
      margin-bottom: 16px;
    }
    .answer {
      padding: 8px;
    }
  </style>
  <script>
    event_log = [];
    function logEvent(type, data) {
      event_log.push({
        type: type,
        time: performance.now()
      });
      if (data) {
        event_log[event_log.length - 1].data = data;
      }
    }
    function handlesubmit() {
      logEvent("submit")
      document.getElementById("log").value = JSON.stringify(event_log, undefined, "  ");
      document.getElementById("summary").value = JSON.stringify(getSummary(event_log), undefined, "  ");
    }
    function getSummary() {
      const summary = {};
      const firstTimes = {};
      const endTimes = {};
      for (var i = 0; i < event_log.length; ++i) {
        const entry = event_log[i];
        if (!firstTimes[entry.type]) {
          firstTimes[entry.type] = entry.time;
        }
        endTimes[entry.type] = entry.time;
      }

      summary.helloMs = endTimes.hello - firstTimes.hello;
      summary.johnSmithMs = endTimes.johnsmith - firstTimes.johnsmith;
      summary.passwordMs = endTimes.password - firstTimes.password;
      summary.nameMs = endTimes.name - firstTimes.name;
      summary.allMs = endTimes.submit - firstTimes.start;

      return summary;
    }
    function onInput(name, e) {
      logEvent(name, {
        value: e.target.value
      });
    }

    logEvent("start");
  </script>
</head>
<body>
  <form action="https://docs.google.com/forms/d/e/1FAIpQLSdl3b0JqQPxCO-YV9lQH6gLD0nTOh0kkSoXFHFaCIDakwS8lg/formResponse" target="_self" method="POST" onsubmit="handlesubmit()">
    <div class="question">
      Please select the keyboard layout
      <div class="answer">
        <select name="entry.1029536509" required>
          <option value="Default">Default</option>
          <option value="Compact 48">Compact 48</option>
          <option value="Medium 48">Medium 48</option>
          <option value="Wide 48">Wide 48</option>
          <option value="Compact 36">Compact 36</option>
          <option value="Medium 36">Medium 36</option>
          <option value="Wide 36">Wide 36</option>
          <option value="Compact 32">Compact 32</option>
          <option value="Medium 32">Medium 32</option>
          <option value="Wide 32">Wide 32</option>
        </select>
      </div>
    </div>
    <div class="question">
      Please type "hello"
      <div class="answer"><input type="text" name="entry.1774757950" value="" pattern="hello" oninput="onInput('hello', arguments[0])" required></input></div>
    </div>
    <div class="question">
      Please type "John Smith" (case sensitive)
      <div class="answer"><input type="text" name="entry.1833463999" value="" pattern="John Smith" oninput="onInput('johnsmith', arguments[0])" required></input></div>
    </div>
    <div class="question">
      Please type "pa1ss2wo3rd4".
      <div class="answer"><input type="text" name="entry.778886309" value="" pattern="pa1ss2wo3rd4" oninput="onInput('password', arguments[0])" required></input></div>
    </div>
    <div class="question">
      Please type your name.
      <div class="answer"><input type="text" name="entry.736420603" value="" oninput="onInput('name', arguments[0])" required></input></div>
    </div>
    <input type="hidden" id="log" name="entry.1345513042"></input>
    <input type="hidden" id="summary" name="entry.858984254"></input>
    <div>
      <input type="submit"></input>
    </div>
  </form>
</body>
</html>
